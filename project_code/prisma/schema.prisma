generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model Student {
  id       String           @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  email    String           @unique
  password String
  courses  Course[]         @relation(fields: [courseId], references: [id])
  courseId String[]         @db.ObjectId
  profile  StudentProfile?
  register RegisterCourse[]
}

model Tutor {
  id             String              @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  email          String              @unique
  password       String
  courses        Course[]            @relation(fields: [courseId], references: [id])
  courseId       String[]            @db.ObjectId
  profile        TutorProfile?
  availabilities TutorAvailability[]
}

model SiteAdmin {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  email    String @unique
  password String
}

model TutorAdmin {
  id       String @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  email    String @unique
  password String
}

model Course {
  id             String              @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  description    String?
  tags           String[]
  comments       String[]
  thumbnail      String?
  students       Student[]           @relation(fields: [studentId], references: [id])
  studentId      String[]            @db.ObjectId
  tutors         Tutor[]             @relation(fields: [tutorId], references: [id])
  tutorId        String[]            @db.ObjectId
  price          Int
  availabilities TutorAvailability[]
  register       RegisterCourse[]
  status         String?
}

model TutorAvailability {
  id        String @id @default(auto()) @map("_id") @db.ObjectId
  tutor     Tutor  @relation(fields: [tutorId], references: [id])
  tutorId   String @db.ObjectId
  course    Course @relation(fields: [courseId], references: [id])
  courseId  String @db.ObjectId
  startTime String
  endTime   String
}

model StudentProfile {
  id             String  @id @default(auto()) @map("_id") @db.ObjectId
  thumbnail      String?
  email          String
  username       String
  phone          String?
  address        String?
  timeZone       String?
  biography      String?
  accountBalance Int
  student        Student @relation(fields: [studentId], references: [id])
  studentId      String  @unique @db.ObjectId
}

model TutorProfile {
  id                String  @id @default(auto()) @map("_id") @db.ObjectId
  thumbnail         String?
  email             String  @unique
  username          String
  phone             String?
  address           String?
  timeZone          String?
  professionalBio   String?
  accountBalance    Int     @default(10)
  experienceSummary String?
  courseCanTeach    String?
  tutor             Tutor   @relation(fields: [tutorId], references: [id])
  tutorId           String  @unique @db.ObjectId
}

model TutorApplication {
  id          String     @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  email       String
  courseName  String
  date        DateTime   @default(now())
  description String
  interview   Interview?
  status      String?
}

model Interview {
  id            String           @id @default(auto()) @map("_id") @db.ObjectId
  name          String
  email         String           @unique
  courseName    String
  date          String
  application   TutorApplication @relation(fields: [applicationId], references: [id])
  applicationId String           @unique @db.ObjectId
  status        String?
  description   String?
}

model Appointment {
  id              String  @id @default(auto()) @map("_id") @db.ObjectId
  courseName      String?
  tutorName       String?
  tutorEmail      String?
  studentName     String?
  studentEmail    String?
  duration        Int     @default(1)
  date            String?
  startTime       String?
  endTime         String?
  status          String?
  appointmentDate String?
}

model RegisterCourse {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  studentId String
  student   Student  @relation(fields: [studentId], references: [id])
  courseId  String
  course    Course   @relation(fields: [courseId], references: [id])
  date      DateTime
  status    String
}

model Identity {
  id       String   @id @default(auto()) @map("_id") @db.ObjectId
  email    String   @unique
  userType UserType
}

enum UserType {
  Student
  Tutor
  SiteAdmin
  TutorAdmin
}
